import{b as S,r as l,j as e,B as p,C as T,U as u,T as k,A as j}from"./index-ClNmCw7p.js";import{S as i}from"./StatsCard-DR0iLUrn.js";import{T as g,C as A}from"./triangle-alert-D7R5kbgJ.js";import{R as D,L,C as $,X as G,Y as _,T as E,a as d}from"./LineChart-0g-vu1lZ.js";import{C as H}from"./clock-Bgv1fdHG.js";function q(){const{apiCall:n}=S(),[a,v]=l.useState(null),[r,b]=l.useState(null),[o,N]=l.useState([]),[w,c]=l.useState(!0),[m,x]=l.useState(null);l.useEffect(()=>{h();const s=setInterval(h,3e4);return()=>clearInterval(s)},[]);const h=async()=>{try{c(!0),x(null);const[s,t,C]=await Promise.all([n("/analytics/global").catch(()=>null),n("/monitoring/health").catch(()=>null),n("/monitoring/logs?limit=10").catch(()=>null)]);s?.success&&v(s.data),t?.success&&b(t.data);const R=[{id:1,type:"tenant_created",description:"New tenant onboarded",tenantName:"Showroom Motor Jaya",timestamp:new Date(Date.now()-120*1e3),severity:"info"},{id:2,type:"system_alert",description:"High memory usage detected",timestamp:new Date(Date.now()-900*1e3),severity:"warning"},{id:3,type:"user_login",description:"Super admin login",timestamp:new Date(Date.now()-1800*1e3),severity:"info"}];N(C?.data?.items||R)}catch(s){x("Failed to load dashboard data"),console.error("Dashboard data loading error:",s)}finally{c(!1)}};if(w&&!a)return e.jsx("div",{className:"space-y-6",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[1,2,3,4].map(s=>e.jsx("div",{className:"animate-pulse",children:e.jsxs("div",{className:"bg-slate-800 border border-slate-700 rounded-xl p-6",children:[e.jsx("div",{className:"w-12 h-12 bg-slate-700 rounded-lg mb-4"}),e.jsx("div",{className:"w-24 h-4 bg-slate-700 rounded mb-2"}),e.jsx("div",{className:"w-16 h-8 bg-slate-700 rounded"})]})},s))})});if(m)return e.jsx("div",{className:"bg-red-900/20 border border-red-800/50 rounded-xl p-6",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(g,{className:"w-5 h-5 text-red-400"}),e.jsx("p",{className:"text-red-400",children:m})]})});const f=s=>{switch(s){case"healthy":return"text-green-400";case"degraded":return"text-yellow-400";case"critical":return"text-red-400";default:return"text-slate-400"}},y=(s,t)=>{switch(s){case"tenant_created":return e.jsx(p,{className:"w-4 h-4 text-blue-400"});case"system_alert":return e.jsx(g,{className:`w-4 h-4 ${t==="error"?"text-red-400":"text-yellow-400"}`});case"user_login":return e.jsx(u,{className:"w-4 h-4 text-green-400"});default:return e.jsx(j,{className:"w-4 h-4 text-slate-400"})}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"Dashboard"}),e.jsx("p",{className:"text-slate-400",children:"Global overview of all tenants and system health"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx(i,{title:"Total Tenants",value:a?.overview.totalTenants||0,icon:p,trend:{value:a?.growth.tenantGrowthRate||0,period:"vs last month"},color:"blue"}),e.jsx(i,{title:"Total Cars",value:a?.overview.totalCars||0,icon:T,description:`${a?.overview.availableCars||0} available`,color:"green"}),e.jsx(i,{title:"Total Leads",value:a?.overview.totalLeads||0,icon:u,trend:{value:a?.growth.leadGrowthRate||0,period:"vs last month"},color:"purple"}),e.jsx(i,{title:"Cars Sold",value:a?.overview.soldCars||0,icon:k,trend:{value:a?.growth.salesGrowthRate||0,period:"vs last month"},color:"yellow"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-slate-800 border border-slate-700 rounded-xl p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Growth Trends"}),e.jsx(D,{width:"100%",height:300,children:e.jsxs(L,{data:a?.trends||[],children:[e.jsx($,{strokeDasharray:"3 3",stroke:"#334155"}),e.jsx(G,{dataKey:"period",stroke:"#94a3b8"}),e.jsx(_,{stroke:"#94a3b8"}),e.jsx(E,{contentStyle:{backgroundColor:"#1e293b",border:"1px solid #334155",borderRadius:"8px"}}),e.jsx(d,{type:"monotone",dataKey:"tenants",stroke:"#3b82f6",strokeWidth:2,dot:{fill:"#3b82f6"}}),e.jsx(d,{type:"monotone",dataKey:"leads",stroke:"#8b5cf6",strokeWidth:2,dot:{fill:"#8b5cf6"}}),e.jsx(d,{type:"monotone",dataKey:"sales",stroke:"#10b981",strokeWidth:2,dot:{fill:"#10b981"}})]})})]}),e.jsxs("div",{className:"bg-slate-800 border border-slate-700 rounded-xl p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"System Health"}),e.jsx("div",{className:"space-y-4",children:r?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-700/50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(A,{className:"w-5 h-5 text-green-400"}),e.jsx("span",{className:"text-white",children:"Overall Status"})]}),e.jsx("span",{className:`font-medium ${f(r.status)}`,children:r.status.toUpperCase()})]}),Object.entries(r.services).map(([s,t])=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-slate-400 capitalize",children:s}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:`
                        w-2 h-2 rounded-full
                        ${t.status==="healthy"?"bg-green-400":""}
                        ${t.status==="degraded"?"bg-yellow-400":""}
                        ${t.status==="down"?"bg-red-400":""}
                      `}),e.jsx("span",{className:"text-slate-300 text-sm",children:t.responseTime?`${t.responseTime}ms`:t.status})]})]},s)),e.jsx("div",{className:"pt-4 border-t border-slate-700",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-400",children:"Avg Response Time"}),e.jsxs("p",{className:"text-white font-medium",children:[r.performance.avgResponseTime,"ms"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-400",children:"Error Rate"}),e.jsxs("p",{className:"text-white font-medium",children:[r.performance.errorRate,"%"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-400",children:"Uptime"}),e.jsxs("p",{className:"text-white font-medium",children:[r.performance.uptime,"%"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-400",children:"Request Rate"}),e.jsxs("p",{className:"text-white font-medium",children:[r.performance.requestRate,"/s"]})]})]})})]}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"w-8 h-8 border-2 border-blue-600 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),e.jsx("p",{className:"text-slate-400",children:"Loading system health..."})]})})]})]}),e.jsxs("div",{className:"bg-slate-800 border border-slate-700 rounded-xl p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Recent Activity"}),e.jsx("div",{className:"space-y-3",children:o.length>0?o.map(s=>e.jsxs("div",{className:"flex items-center space-x-3 p-3 hover:bg-slate-700/30 rounded-lg transition-colors",children:[y(s.type,s.severity),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-white",children:s.description}),s.tenantName&&e.jsx("p",{className:"text-slate-400 text-sm",children:s.tenantName})]}),e.jsxs("div",{className:"flex items-center space-x-2 text-slate-500 text-sm",children:[e.jsx(H,{className:"w-4 h-4"}),e.jsx("span",{children:new Date(s.timestamp).toLocaleTimeString()})]})]},s.id)):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(j,{className:"w-12 h-12 text-slate-600 mx-auto mb-4"}),e.jsx("p",{className:"text-slate-400",children:"No recent activity"})]})})]})]})}export{q as default};
