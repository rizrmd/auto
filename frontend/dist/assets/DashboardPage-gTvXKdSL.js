import{c as D,j as e,T as H,a as M,r,R,B as A,C as k,H as $,U as I}from"./index-Cu-C8ibM.js";import{M as _}from"./minus-CyDBAHxm.js";import{A as U}from"./AnalyticsChart-BDBeDhnw.js";import{M as C}from"./message-square-DDA8iZEj.js";/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E=[["path",{d:"M16 17h6v-6",key:"t6n2it"}],["path",{d:"m22 17-8.5-8.5-5 5L2 7",key:"x473p"}]],z=D("trending-down",E),B={blue:{bg:"bg-blue-600",bgLight:"bg-blue-600/10",text:"text-blue-400",border:"border-blue-600/20"},green:{bg:"bg-green-600",bgLight:"bg-green-600/10",text:"text-green-400",border:"border-green-600/20"},yellow:{bg:"bg-yellow-600",bgLight:"bg-yellow-600/10",text:"text-yellow-400",border:"border-yellow-600/20"},red:{bg:"bg-red-600",bgLight:"bg-red-600/10",text:"text-red-400",border:"border-red-600/20"},purple:{bg:"bg-purple-600",bgLight:"bg-purple-600/10",text:"text-purple-400",border:"border-purple-600/20"},indigo:{bg:"bg-indigo-600",bgLight:"bg-indigo-600/10",text:"text-indigo-400",border:"border-indigo-600/20"}};function m({title:x,value:f,icon:h,trend:a,description:s,color:o="blue",loading:p=!1,onClick:n}){const c=B[o];if(p)return e.jsx("div",{className:"bg-slate-800 border border-slate-700 rounded-xl p-6",children:e.jsxs("div",{className:"animate-pulse",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("div",{className:"w-12 h-12 bg-slate-700 rounded-lg"}),e.jsx("div",{className:"w-16 h-4 bg-slate-700 rounded"})]}),e.jsx("div",{className:"w-24 h-8 bg-slate-700 rounded mb-2"}),e.jsx("div",{className:"w-32 h-4 bg-slate-700 rounded"})]})});const i=()=>a?a.value>0?H:a.value<0?z:_:null,u=()=>a?a.value>0?"text-green-400":a.value<0?"text-red-400":"text-slate-400":"",d=i();return e.jsxs("div",{className:`
        bg-slate-800 border border-slate-700 rounded-xl p-6
        hover:border-slate-600 transition-all duration-200
        ${n?"cursor-pointer hover:shadow-lg":""}
      `,onClick:n,children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("div",{className:`
          w-12 h-12 ${c.bgLight} rounded-lg flex items-center justify-center
        `,children:e.jsx(h,{className:`w-6 h-6 ${c.text}`})}),a&&e.jsxs("div",{className:`flex items-center space-x-1 ${u()}`,children:[d&&e.jsx(d,{className:"w-4 h-4"}),e.jsxs("span",{className:"text-sm font-medium",children:[Math.abs(a.value),"%"]})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-400 text-sm mb-1",children:x}),e.jsx("p",{className:"text-white text-2xl font-bold mb-2",children:f}),s&&e.jsx("p",{className:"text-slate-500 text-xs",children:s}),a&&e.jsx("p",{className:"text-slate-500 text-xs mt-1",children:a.period})]})]})}function q(){console.log("ðŸš€ Super Admin Dashboard mounting with real data...");const{isAuthenticated:x,isLoading:f,superAdmin:h}=M(),a=localStorage.getItem("super_admin_token"),[s,o]=r.useState({totalTenants:0,activeTenants:0,totalCars:0,availableCars:0,totalLeads:0,activeLeads:0,totalUsers:0,activeUsers:0,systemHealth:"healthy",whatsappStatus:"connected"}),[p,n]=r.useState([]),[c,i]=r.useState([]),[u,d]=r.useState(!0),[w,N]=r.useState(null),[g,y]=r.useState(!1);if(!x)return R.useEffect(()=>{window.location.href="/super-admin/login"},[]),e.jsx("div",{className:"min-h-screen bg-slate-900 flex items-center justify-center",children:e.jsx("p",{className:"text-white",children:"Redirecting to login..."})});const b=async()=>{if(a)try{d(!0),N(null);const t=await fetch("/api/super-admin/analytics/global",{headers:{Authorization:`Bearer ${a}`,"Content-Type":"application/json"}});if(t.ok){const l=await t.json();o({totalTenants:l.totalTenants||2,activeTenants:l.activeTenants||2,totalCars:l.totalCars||4,availableCars:l.availableCars||4,totalLeads:l.totalLeads||6,activeLeads:l.activeLeads||6,totalUsers:l.totalUsers||5,activeUsers:l.activeUsers||4,systemHealth:l.systemHealth||"healthy",whatsappStatus:l.whatsappStatus||"connected"})}const S=await fetch("/api/super-admin/analytics/activity",{headers:{Authorization:`Bearer ${a}`,"Content-Type":"application/json"}});if(S.ok){const l=await S.json();n(l.recentActivity||v())}else n(v());const T=await fetch("/api/super-admin/analytics/top-tenants",{headers:{Authorization:`Bearer ${a}`,"Content-Type":"application/json"}});if(T.ok){const l=await T.json();i(l.topTenants||j())}else i(j())}catch(t){console.error("Failed to fetch dashboard data:",t),N("Failed to load dashboard data"),o({totalTenants:2,activeTenants:2,totalCars:4,availableCars:4,totalLeads:6,activeLeads:6,totalUsers:5,activeUsers:4,systemHealth:"healthy",whatsappStatus:"connected"}),n(v()),i(j())}finally{d(!1),y(!1)}},v=()=>[{id:"1",type:"tenant_created",message:"New tenant AutoLeads Motors created",timestamp:new Date(Date.now()-1e3*60*30).toISOString(),tenantId:1,tenantName:"AutoLeads Motors"},{id:"2",type:"car_added",message:"Toyota Avanza 2020 added to catalog",timestamp:new Date(Date.now()-1e3*60*60*2).toISOString(),tenantId:1,tenantName:"AutoLeads Motors"},{id:"3",type:"lead_received",message:"New lead received from WhatsApp",timestamp:new Date(Date.now()-1e3*60*60*4).toISOString(),tenantId:2,tenantName:"PrimaMobil"},{id:"4",type:"user_login",message:"Admin user logged in",timestamp:new Date(Date.now()-1e3*60*60*6).toISOString(),tenantId:1,tenantName:"AutoLeads Motors"}],j=()=>[{id:1,name:"AutoLeads Motors",cars:4,leads:6,conversionRate:85.5,status:"active"},{id:2,name:"PrimaMobil",cars:3,leads:4,conversionRate:75,status:"active"}];r.useEffect(()=>{b()},[]),r.useEffect(()=>{const t=setInterval(()=>{b()},3e4);return()=>clearInterval(t)},[]);const L=()=>{y(!0),b()};return u&&!g?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):w?e.jsx("div",{className:"bg-red-900/20 border border-red-800/50 rounded-xl p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"text-red-400 mr-3",children:"âš ï¸"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-red-400 font-medium",children:"Error Loading Dashboard"}),e.jsx("p",{className:"text-red-300 text-sm mt-1",children:w}),e.jsx("button",{onClick:L,className:"mt-3 px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700 transition-colors",children:"Try Again"})]})]})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-white",children:"Dashboard Overview"}),e.jsxs("p",{className:"text-slate-400 mt-1",children:["Welcome back, ",h?.name||"Super Admin","! Here's what's happening in your system."]})]}),e.jsxs("button",{onClick:L,disabled:g,className:"flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50",children:[e.jsx("svg",{className:`w-4 h-4 mr-2 ${g?"animate-spin":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Refresh"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx(m,{title:"Total Tenants",value:s.totalTenants,description:`${s.activeTenants} active`,icon:A,color:"blue",trend:{value:12,period:"vs last month"}}),e.jsx(m,{title:"Total Cars",value:s.totalCars,description:`${s.availableCars} available`,icon:k,color:"green",trend:{value:8,period:"vs last month"}}),e.jsx(m,{title:"Total Leads",value:s.totalLeads,description:`${s.activeLeads} active`,icon:C,color:"purple",trend:{value:25,period:"vs last month"}}),e.jsx(m,{title:"System Health",value:s.systemHealth==="healthy"?"Good":s.systemHealth,description:"All systems operational",icon:$,color:s.systemHealth==="healthy"?"green":s.systemHealth==="warning"?"yellow":"red"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx(U,{type:"line",title:"Leads Overview",subtitle:"Last 7 days performance",data:[{name:"Mon",leads:12},{name:"Tue",leads:19},{name:"Wed",leads:15},{name:"Thu",leads:25},{name:"Fri",leads:22},{name:"Sat",leads:30},{name:"Sun",leads:28}],series:[{key:"leads",name:"Leads",color:"#8b5cf6"}],height:250}),e.jsxs("div",{className:"bg-slate-800 border border-slate-700 rounded-xl p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Recent Activity"}),e.jsx("span",{className:"text-sm text-slate-400",children:"Last 24 hours"})]}),e.jsx("div",{className:"space-y-3 max-h-64 overflow-y-auto",children:p.map(t=>e.jsxs("div",{className:"flex items-start space-x-3 p-3 hover:bg-slate-700/30 rounded-lg transition-colors",children:[e.jsxs("div",{className:"flex-shrink-0",children:[t.type==="tenant_created"&&e.jsx(A,{className:"w-6 h-6 text-blue-400"}),t.type==="car_added"&&e.jsx(k,{className:"w-6 h-6 text-green-400"}),t.type==="lead_received"&&e.jsx(C,{className:"w-6 h-6 text-purple-400"}),t.type==="user_login"&&e.jsx(I,{className:"w-6 h-6 text-yellow-400"})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-white",children:t.message}),e.jsxs("p",{className:"text-xs text-slate-400",children:[t.tenantName&&`${t.tenantName} â€¢ `,new Date(t.timestamp).toLocaleString()]})]})]},t.id))})]})]}),e.jsxs("div",{className:"bg-slate-800 border border-slate-700 rounded-xl",children:[e.jsx("div",{className:"px-6 py-4 border-b border-slate-700",children:e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Top Performing Tenants"})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-slate-700",children:[e.jsx("thead",{className:"bg-slate-900",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-400 uppercase tracking-wider",children:"Tenant Name"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-400 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-400 uppercase tracking-wider",children:"Cars"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-400 uppercase tracking-wider",children:"Leads"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-400 uppercase tracking-wider",children:"Conversion Rate"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-400 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-slate-800 divide-y divide-slate-700",children:c.map(t=>e.jsxs("tr",{className:"hover:bg-slate-700/30",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm font-medium text-white",children:t.name})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${t.status==="active"?"bg-green-900/50 text-green-400":t.status==="trial"?"bg-yellow-900/50 text-yellow-400":"bg-red-900/50 text-red-400"}`,children:t.status})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-white",children:t.cars}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-white",children:t.leads}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsxs("span",{className:"text-sm text-white mr-2",children:[t.conversionRate,"%"]}),e.jsx("div",{className:"w-16 bg-slate-700 rounded-full h-2",children:e.jsx("div",{className:"bg-green-500 h-2 rounded-full",style:{width:`${t.conversionRate}%`}})})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:e.jsx("button",{onClick:()=>window.location.href=`/super-admin/tenants/${t.id}`,className:"text-blue-400 hover:text-blue-300",children:"View Details"})})]},t.id))})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"bg-slate-800 border border-slate-700 rounded-xl p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:`w-3 h-3 rounded-full ${s.whatsappStatus==="connected"?"bg-green-400":s.whatsappStatus==="disconnected"?"bg-yellow-400":"bg-red-400"}`})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("h3",{className:"text-sm font-medium text-white",children:"WhatsApp Service"}),e.jsx("p",{className:"text-sm text-slate-400 capitalize",children:s.whatsappStatus})]})]})}),e.jsx("div",{className:"bg-slate-800 border border-slate-700 rounded-xl p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:`w-3 h-3 rounded-full ${s.systemHealth==="healthy"?"bg-green-400":s.systemHealth==="warning"?"bg-yellow-400":"bg-red-400"}`})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("h3",{className:"text-sm font-medium text-white",children:"System Health"}),e.jsx("p",{className:"text-sm text-slate-400 capitalize",children:s.systemHealth})]})]})}),e.jsx("div",{className:"bg-slate-800 border border-slate-700 rounded-xl p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-3 h-3 rounded-full bg-green-400"})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("h3",{className:"text-sm font-medium text-white",children:"Database"}),e.jsx("p",{className:"text-sm text-slate-400",children:"Connected"})]})]})})]})]})}export{q as default};
