import{b as S,r as n,j as e,B as P,C as w,U as v,D as N,e as k,T as x}from"./index-Cu-C8ibM.js";import{A as M}from"./AnalyticsChart-BDBeDhnw.js";import{R as F}from"./refresh-cw-DhpQ2tMO.js";import{D as B}from"./download-DVppaqTW.js";import{M as C}from"./message-square-DDA8iZEj.js";function V(){const D=S(),m=localStorage.getItem("super_admin_token"),c=(()=>{const t=D.pathname;return t.includes("/performance")?"performance":t.includes("/revenue")?"revenue":t.includes("/tenants/")?"tenant-detail":"overview"})(),[a,o]=n.useState(null),[L,h]=n.useState(!0),[g,y]=n.useState(null),[s,R]=n.useState({period:"30d",metric:"all"}),[p,u]=n.useState(!1),j=()=>{const t=new Date,l=Array.from({length:30},(i,r)=>({date:new Date(t.getTime()-(29-r)*24*60*60*1e3).toLocaleDateString("en-US",{month:"short",day:"numeric"}),tenants:Math.floor(Math.random()*3)+1,cars:Math.floor(Math.random()*10)+2,leads:Math.floor(Math.random()*25)+5,revenue:Math.floor(Math.random()*5e6)+1e6})),d=Array.from({length:12},(i,r)=>({month:new Date(t.getFullYear(),t.getMonth()-11+r,1).toLocaleDateString("en-US",{month:"short",year:"numeric"}),tenants:Math.floor(Math.random()*5)+1,cars:Math.floor(Math.random()*20)+5,leads:Math.floor(Math.random()*100)+20,revenue:Math.floor(Math.random()*1e7)+5e6}));return{overview:{totalTenants:2,totalCars:7,totalLeads:10,totalUsers:5,totalRevenue:225e4,conversionRate:82.5},trends:{daily:l,monthly:d},topTenants:[{id:1,name:"AutoLeads Motors",leads:6,conversionRate:85.5,revenue:15e5},{id:2,name:"PrimaMobil",leads:4,conversionRate:75,revenue:75e4}],platformMetrics:{whatsappUsage:1250,apiCalls:15680,storageUsed:245.7,systemUptime:99.8}}},b=async()=>{if(m)try{h(!0),y(null);const t=new URLSearchParams({period:s.period,metric:s.metric}),l=await fetch(`/api/super-admin/analytics?${t}`,{headers:{Authorization:`Bearer ${m}`,"Content-Type":"application/json"}});if(l.ok){const d=await l.json();o(d)}else o(j())}catch(t){console.error("Failed to fetch analytics:",t),y("Failed to load analytics data"),o(j())}finally{h(!1),u(!1)}};n.useEffect(()=>{b()},[s,c]);const T=()=>{u(!0),b()},U=()=>{if(!a)return;const t=[["Date","Tenants","Cars","Leads","Revenue"],...a.trends.daily.map(r=>[r.date,r.tenants,r.cars,r.leads,r.revenue])].map(r=>r.join(",")).join(`
`),l=new Blob([t],{type:"text/csv"}),d=window.URL.createObjectURL(l),i=document.createElement("a");i.href=d,i.download=`analytics-${s.period}.csv`,i.click(),window.URL.revokeObjectURL(d)},f=t=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0,maximumFractionDigits:0}).format(t);return c==="tenant-detail"?e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsx("button",{onClick:()=>window.location.href="/super-admin/analytics",className:"flex items-center text-gray-600 hover:text-gray-900 dark:text-gray-400 dark:hover:text-white",children:"← Back to Analytics"})}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-4",children:"Tenant Analytics"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Detailed analytics for specific tenant. This view is under construction."})]})]}):c==="performance"?e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsx("button",{onClick:()=>window.location.href="/super-admin/analytics",className:"flex items-center text-gray-600 hover:text-gray-900 dark:text-gray-400 dark:hover:text-white",children:"← Back to Analytics"})}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-4",children:"Performance Analytics"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"System performance metrics and optimization insights. This view is under construction."})]})]}):c==="revenue"?e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsx("button",{onClick:()=>window.location.href="/super-admin/analytics",className:"flex items-center text-gray-600 hover:text-gray-900 dark:text-gray-400 dark:hover:text-white",children:"← Back to Analytics"})}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-4",children:"Revenue Analytics"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Detailed revenue reports and financial insights. This view is under construction."})]})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"Platform Analytics"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-1",children:"Comprehensive insights and metrics for your multi-tenant platform"})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("button",{onClick:T,disabled:p,className:"flex items-center px-4 py-2 text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 dark:bg-gray-800 dark:text-gray-300 dark:border-gray-600 dark:hover:bg-gray-700 disabled:opacity-50",children:[e.jsx(F,{className:`w-4 h-4 mr-2 ${p?"animate-spin":""}`}),"Refresh"]}),e.jsxs("button",{onClick:U,disabled:!a,className:"flex items-center px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50",children:[e.jsx(B,{className:"w-4 h-4 mr-2"}),"Export"]})]})]}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-4",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Time Period:"}),e.jsx("div",{className:"flex rounded-lg shadow-sm",children:[{value:"7d",label:"7 Days"},{value:"30d",label:"30 Days"},{value:"90d",label:"90 Days"},{value:"1y",label:"1 Year"}].map(t=>e.jsx("button",{onClick:()=>R({...s,period:t.value}),className:`px-4 py-2 text-sm font-medium rounded-l-lg rounded-r-lg ${s.period===t.value?"bg-blue-600 text-white":"bg-white text-gray-700 hover:bg-gray-50 dark:bg-gray-700 dark:text-gray-300 dark:hover:bg-gray-600"} ${t.value!=="7d"?"ml-1":""}`,children:t.label},t.value))})]})})}),g&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:e.jsx("div",{className:"flex items-center",children:e.jsx("span",{className:"text-red-800",children:g})})}),L?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):a?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-6",children:[e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-3 bg-blue-100 dark:bg-blue-900 rounded-lg",children:e.jsx(P,{className:"w-6 h-6 text-blue-600 dark:text-blue-400"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Total Tenants"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:a.overview.totalTenants}),e.jsx("p",{className:"text-xs text-green-600",children:"+12% from last month"})]})]})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-3 bg-green-100 dark:bg-green-900 rounded-lg",children:e.jsx(w,{className:"w-6 h-6 text-green-600 dark:text-green-400"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Total Cars"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:a.overview.totalCars}),e.jsx("p",{className:"text-xs text-green-600",children:"+8% from last month"})]})]})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-3 bg-purple-100 dark:bg-purple-900 rounded-lg",children:e.jsx(C,{className:"w-6 h-6 text-purple-600 dark:text-purple-400"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Total Leads"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:a.overview.totalLeads}),e.jsx("p",{className:"text-xs text-green-600",children:"+25% from last month"})]})]})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-3 bg-yellow-100 dark:bg-yellow-900 rounded-lg",children:e.jsx(v,{className:"w-6 h-6 text-yellow-600 dark:text-yellow-400"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Total Users"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:a.overview.totalUsers}),e.jsx("p",{className:"text-xs text-green-600",children:"+15% from last month"})]})]})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-3 bg-pink-100 dark:bg-pink-900 rounded-lg",children:e.jsx(N,{className:"w-6 h-6 text-pink-600 dark:text-pink-400"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Total Revenue"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:f(a.overview.totalRevenue)}),e.jsx("p",{className:"text-xs text-green-600",children:"+18% from last month"})]})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:["Leads Trend (",s.period==="7d"?"Last 7 Days":s.period==="30d"?"Last 30 Days":s.period==="90d"?"Last 90 Days":"Last Year",")"]}),e.jsx(k,{className:"w-5 h-5 text-gray-500"})]}),e.jsx(M,{type:"line",data:s.period==="1y"?a.trends.monthly.map(t=>({date:t.month,leads:t.leads})):a.trends.daily.slice(-30),color:"#8b5cf6",height:300})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:["Revenue Trend (",s.period==="7d"?"Last 7 Days":s.period==="30d"?"Last 30 Days":s.period==="90d"?"Last 90 Days":"Last Year",")"]}),e.jsx(x,{className:"w-5 h-5 text-gray-500"})]}),e.jsx(M,{type:"area",data:s.period==="1y"?a.trends.monthly.map(t=>({date:t.month,revenue:t.revenue/1e6})):a.trends.daily.slice(-30).map(t=>({date:t.date,revenue:t.revenue/1e6})),color:"#10b981",height:300})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200 dark:border-gray-700",children:e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Top Performing Tenants"})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-900",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Tenant"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Leads"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Conversion Rate"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Revenue"})]})}),e.jsx("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:a.topTenants.map((t,l)=>e.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-blue-100 flex items-center justify-center mr-3",children:e.jsx("span",{className:"text-blue-600 font-semibold text-sm",children:l+1})}),e.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-white",children:t.name})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white",children:t.leads}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsxs("span",{className:"text-sm text-gray-900 dark:text-white mr-2",children:[t.conversionRate,"%"]}),e.jsx("div",{className:"w-16 bg-gray-200 dark:bg-gray-700 rounded-full h-2",children:e.jsx("div",{className:"bg-green-500 h-2 rounded-full",style:{width:`${t.conversionRate}%`}})})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white",children:f(t.revenue)})]},t.id))})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"WhatsApp Usage"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:a.platformMetrics.whatsappUsage.toLocaleString()}),e.jsx("p",{className:"text-xs text-gray-500",children:"Messages this month"})]}),e.jsx("div",{className:"p-3 bg-green-100 dark:bg-green-900 rounded-lg",children:e.jsx(C,{className:"w-6 h-6 text-green-600 dark:text-green-400"})})]})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"API Calls"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:a.platformMetrics.apiCalls.toLocaleString()}),e.jsx("p",{className:"text-xs text-gray-500",children:"Calls this month"})]}),e.jsx("div",{className:"p-3 bg-blue-100 dark:bg-blue-900 rounded-lg",children:e.jsx(k,{className:"w-6 h-6 text-blue-600 dark:text-blue-400"})})]})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Storage Used"}),e.jsxs("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:[a.platformMetrics.storageUsed," GB"]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Of 1000 GB"})]}),e.jsx("div",{className:"p-3 bg-yellow-100 dark:bg-yellow-900 rounded-lg",children:e.jsx(w,{className:"w-6 h-6 text-yellow-600 dark:text-yellow-400"})})]})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"System Uptime"}),e.jsxs("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:[a.platformMetrics.systemUptime,"%"]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Last 30 days"})]}),e.jsx("div",{className:"p-3 bg-green-100 dark:bg-green-900 rounded-lg",children:e.jsx(x,{className:"w-6 h-6 text-green-600 dark:text-green-400"})})]})})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Detailed Analytics"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("button",{onClick:()=>window.location.href="/super-admin/analytics/performance",className:"flex items-center justify-center px-4 py-3 bg-blue-50 text-blue-600 rounded-lg hover:bg-blue-100 dark:bg-blue-900 dark:text-blue-400",children:[e.jsx(x,{className:"w-4 h-4 mr-2"}),"Performance Metrics"]}),e.jsxs("button",{onClick:()=>window.location.href="/super-admin/analytics/revenue",className:"flex items-center justify-center px-4 py-3 bg-green-50 text-green-600 rounded-lg hover:bg-green-100 dark:bg-green-900 dark:text-green-400",children:[e.jsx(N,{className:"w-4 h-4 mr-2"}),"Revenue Reports"]}),e.jsxs("button",{onClick:()=>window.location.href="/super-admin/analytics/tenants",className:"flex items-center justify-center px-4 py-3 bg-purple-50 text-purple-600 rounded-lg hover:bg-purple-100 dark:bg-purple-900 dark:text-purple-400",children:[e.jsx(v,{className:"w-4 h-4 mr-2"}),"Tenant Analytics"]})]})]})]}):null]})}export{V as default};
