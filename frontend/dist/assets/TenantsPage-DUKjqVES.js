import{c as f,u as F,r as h,j as e,B as V,A as q,C as R,U as z,T as J,d as G,b as I,e as X}from"./index-Bte2K8I5.js";import{M as Y}from"./message-square-BbjR1MmS.js";import{E as K}from"./eye-wV_Tm8av.js";import{C as _}from"./circle-x-C3kjYXey.js";import{C as T,T as w}from"./triangle-alert-BjzdEjYO.js";import{C as Q}from"./clock-QYSuSAs0.js";import{D as W}from"./download-efAXHsgS.js";import{R as Z}from"./refresh-cw-BLVaXt3C.js";/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ee=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]],se=f("ellipsis-vertical",ee);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const te=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],ae=f("funnel",te);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const le=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],P=f("plus",le);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const re=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],ne=f("square-pen",re);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ie=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],ce=f("trash-2",ie),$=t=>t>=80?"text-green-400":t>=60?"text-yellow-400":"text-red-400",oe=t=>t>=80?"bg-green-400/10":t>=60?"bg-yellow-400/10":"bg-red-400/10",M=t=>{switch(t){case"active":return"bg-green-400";case"suspended":return"bg-red-400";case"trial":return"bg-blue-400";case"expired":return"bg-gray-400";default:return"bg-gray-400"}},de=t=>{switch(t){case"active":return T;case"suspended":return _;case"trial":return Q;case"expired":return w;default:return w}};function xe({tenant:t,onEdit:u,onSuspend:o,onActivate:y,onViewAnalytics:g,showActions:N=!0}){const j=F(),[b,a]=h.useState(!1),m=()=>{j(`/super-admin/tenants/${t.id}`)},c=n=>{n.stopPropagation(),u?.(t)},C=n=>{n.stopPropagation(),o?.(t)},i=n=>{n.stopPropagation(),y?.(t)},p=n=>{n.stopPropagation(),g?.(t)},v=n=>{if(!n)return"Never";const d=new Date().getTime()-new Date(n).getTime(),x=Math.floor(d/(1e3*60*60*24));return x===0?"Today":x===1?"Yesterday":x<7?`${x} days ago`:x<30?`${Math.floor(x/7)} weeks ago`:`${Math.floor(x/30)} months ago`},k=de(t.status);return e.jsxs("div",{className:"group relative bg-slate-800 border border-slate-700 rounded-xl p-6 hover:border-slate-600 transition-all duration-200 hover:shadow-lg cursor-pointer",children:[e.jsx("div",{className:"absolute top-4 right-4",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${M(t.status)}`}),e.jsx(k,{className:`w-4 h-4 ${M(t.status)}`})]})}),e.jsx("div",{className:"flex items-start justify-between mb-4",onClick:m,children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-12 h-12 bg-slate-700 rounded-lg flex items-center justify-center",children:e.jsx(V,{className:"w-6 h-6 text-slate-300"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-white font-semibold text-lg",children:t.name}),e.jsxs("p",{className:"text-slate-400 text-sm",children:[t.subdomain,".autoleads.com"]}),t.customDomain&&e.jsx("p",{className:"text-slate-500 text-xs",children:t.customDomain})]})]})}),e.jsxs("div",{className:`
        flex items-center justify-between p-3 rounded-lg mb-4
        ${oe(t.healthScore)}
      `,onClick:m,children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(q,{className:`w-5 h-5 ${$(t.healthScore)}`}),e.jsx("span",{className:"text-slate-300 text-sm",children:"Health Score"})]}),e.jsxs("span",{className:`font-bold ${$(t.healthScore)}`,children:[t.healthScore,"%"]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",onClick:m,children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(R,{className:"w-4 h-4 text-slate-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-medium",children:t._count.cars}),e.jsx("p",{className:"text-slate-500 text-xs",children:"Cars"})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Y,{className:"w-4 h-4 text-slate-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-medium",children:t._count.leads}),e.jsx("p",{className:"text-slate-500 text-xs",children:"Leads"})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(z,{className:"w-4 h-4 text-slate-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-medium",children:t._count.users}),e.jsx("p",{className:"text-slate-500 text-xs",children:"Users"})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(J,{className:"w-4 h-4 text-slate-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-medium",children:t._count.soldCars}),e.jsx("p",{className:"text-slate-500 text-xs",children:"Sold"})]})]})]}),e.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-slate-700",children:[e.jsxs("div",{className:"text-sm text-slate-400",children:["Last active: ",v(t.lastActivity)]}),N&&e.jsxs("div",{className:"relative",children:[e.jsx("button",{onClick:n=>{n.stopPropagation(),a(!b)},className:"p-2 text-slate-400 hover:text-white hover:bg-slate-700 rounded-lg transition-colors",children:e.jsx(se,{className:"w-4 h-4"})}),b&&e.jsxs("div",{className:"absolute right-0 mt-2 w-48 bg-slate-800 border border-slate-700 rounded-lg shadow-xl z-10 overflow-hidden",children:[e.jsxs("button",{onClick:p,className:"flex items-center space-x-3 w-full px-4 py-3 text-slate-300 hover:text-white hover:bg-slate-700 transition-colors",children:[e.jsx(K,{className:"w-4 h-4"}),e.jsx("span",{children:"View Analytics"})]}),e.jsxs("button",{onClick:c,className:"flex items-center space-x-3 w-full px-4 py-3 text-slate-300 hover:text-white hover:bg-slate-700 transition-colors",children:[e.jsx(ne,{className:"w-4 h-4"}),e.jsx("span",{children:"Edit Tenant"})]}),e.jsxs("button",{onClick:()=>j(`/super-admin/tenants/${t.id}/theme`),className:"flex items-center space-x-3 w-full px-4 py-3 text-slate-300 hover:text-white hover:bg-slate-700 transition-colors",children:[e.jsx(G,{className:"w-4 h-4"}),e.jsx("span",{children:"Theme Settings"})]}),e.jsx("div",{className:"border-t border-slate-700",children:t.status==="active"?e.jsxs("button",{onClick:C,className:"flex items-center space-x-3 w-full px-4 py-3 text-red-400 hover:text-red-300 hover:bg-slate-700 transition-colors",children:[e.jsx(_,{className:"w-4 h-4"}),e.jsx("span",{children:"Suspend Tenant"})]}):e.jsxs("button",{onClick:i,className:"flex items-center space-x-3 w-full px-4 py-3 text-green-400 hover:text-green-300 hover:bg-slate-700 transition-colors",children:[e.jsx(T,{className:"w-4 h-4"}),e.jsx("span",{children:"Activate Tenant"})]})})]})]})]})]})}function Ne(){const t=F(),{apiCall:u}=I(),[o,y]=h.useState([]),[g,N]=h.useState(!0),[j,b]=h.useState(null),[a,m]=h.useState({search:"",status:"",plan:"",sortBy:"name",sortOrder:"asc",page:1,limit:12}),[c,C]=h.useState({total:0,totalPages:0,hasNext:!1,hasPrev:!1}),[i,p]=h.useState([]),[v,k]=h.useState(!1);h.useEffect(()=>{n()},[a]);const n=async()=>{try{N(!0),b(null);const s=new URLSearchParams;a.search&&s.append("search",a.search),a.status&&s.append("status",a.status),a.plan&&s.append("plan",a.plan),a.sortBy&&s.append("sortBy",a.sortBy),a.sortOrder&&s.append("sortOrder",a.sortOrder),s.append("page",a.page?.toString()||"1"),s.append("limit",a.limit?.toString()||"12");const l=await u(`/tenants?${s.toString()}`);l.success&&(y(l.data.items),C(l.data.pagination))}catch(s){b("Failed to load tenants"),console.error("Tenants loading error:",s)}finally{N(!1)}},A=s=>{m(l=>({...l,search:s,page:1}))},d=(s,l)=>{m(r=>({...r,[s]:l,page:1}))},x=s=>{t(`/super-admin/tenants/${s.id}/edit`)},E=async s=>{if(confirm(`Are you sure you want to suspend ${s.name}?`))try{const l=await u(`/tenants/${s.id}/status`,{method:"PUT",body:JSON.stringify({status:"suspended"})});l.success?n():alert(l.error||"Failed to suspend tenant")}catch(l){console.error("Tenant suspend error:",l),alert("Failed to suspend tenant")}},B=async s=>{try{const l=await u(`/tenants/${s.id}/status`,{method:"PUT",body:JSON.stringify({status:"active"})});l.success?n():alert(l.error||"Failed to activate tenant")}catch(l){console.error("Tenant activate error:",l),alert("Failed to activate tenant")}},O=s=>{t(`/super-admin/analytics/tenants/${s.id}`)},S=async s=>{if(i.length===0)return;const l={activate:`Are you sure you want to activate ${i.length} tenant(s)?`,suspend:`Are you sure you want to suspend ${i.length} tenant(s)?`,delete:`Are you sure you want to delete ${i.length} tenant(s)? This action cannot be undone.`};if(confirm(l[s]))try{const r=await u("/tenants/bulk-action",{method:"POST",body:JSON.stringify({action:s,tenantIds:i})});r.success?(p([]),n()):alert(r.error||`Failed to ${s} tenants`)}catch(r){console.error("Bulk action error:",r),alert(`Failed to ${s} tenants`)}},D=async()=>{try{const s=await u("/tenants/export",{method:"POST",body:JSON.stringify({filters:a})});s.success&&s.data.downloadUrl&&window.open(s.data.downloadUrl,"_blank")}catch(s){console.error("Export error:",s),alert("Failed to export tenants")}},L=s=>{p(l=>l.includes(s)?l.filter(r=>r!==s):[...l,s])},U=()=>{i.length===o.length?p([]):p(o.map(s=>s.id))};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"Tenants"}),e.jsxs("p",{className:"text-slate-400",children:["Manage all ",c.total," tenants and their configurations"]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[i.length>0&&e.jsxs("div",{className:"flex items-center space-x-2 bg-slate-800 border border-slate-700 rounded-lg px-3 py-2",children:[e.jsxs("span",{className:"text-slate-300 text-sm",children:[i.length," selected"]}),e.jsx("button",{onClick:()=>S("activate"),className:"text-green-400 hover:text-green-300",title:"Activate selected",children:e.jsx(T,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>S("suspend"),className:"text-yellow-400 hover:text-yellow-300",title:"Suspend selected",children:e.jsx(w,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>S("delete"),className:"text-red-400 hover:text-red-300",title:"Delete selected",children:e.jsx(ce,{className:"w-4 h-4"})})]}),e.jsxs("button",{onClick:D,className:"px-4 py-2 text-slate-300 hover:text-white hover:bg-slate-700 rounded-lg transition-colors flex items-center space-x-2",children:[e.jsx(W,{className:"w-4 h-4"}),e.jsx("span",{children:"Export"})]}),e.jsxs("button",{onClick:()=>t("/super-admin/tenants/create"),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors flex items-center space-x-2",children:[e.jsx(P,{className:"w-4 h-4"}),e.jsx("span",{children:"Add Tenant"})]})]})]}),e.jsxs("div",{className:"bg-slate-800 border border-slate-700 rounded-xl p-6",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx(X,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-slate-400"}),e.jsx("input",{type:"text",placeholder:"Search tenants by name, domain, or email...",value:a.search,onChange:s=>A(s.target.value),className:"w-full pl-10 pr-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white placeholder-slate-400 focus:outline-none focus:border-blue-500"})]})}),e.jsxs("button",{onClick:()=>k(!v),className:`px-4 py-2 rounded-lg transition-colors flex items-center space-x-2 ${v?"bg-blue-600 text-white":"text-slate-300 hover:text-white hover:bg-slate-700"}`,children:[e.jsx(ae,{className:"w-4 h-4"}),e.jsx("span",{children:"Filters"})]}),e.jsxs("button",{onClick:n,disabled:g,className:"px-4 py-2 text-slate-300 hover:text-white hover:bg-slate-700 rounded-lg transition-colors flex items-center space-x-2 disabled:opacity-50",children:[e.jsx(Z,{className:`w-4 h-4 ${g?"animate-spin":""}`}),e.jsx("span",{children:"Refresh"})]})]}),v&&e.jsxs("div",{className:"mt-6 grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-slate-300 text-sm font-medium mb-2",children:"Status"}),e.jsxs("select",{value:a.status,onChange:s=>d("status",s.target.value),className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-blue-500",children:[e.jsx("option",{value:"",children:"All Status"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"suspended",children:"Suspended"}),e.jsx("option",{value:"trial",children:"Trial"}),e.jsx("option",{value:"expired",children:"Expired"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-slate-300 text-sm font-medium mb-2",children:"Plan"}),e.jsxs("select",{value:a.plan,onChange:s=>d("plan",s.target.value),className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-blue-500",children:[e.jsx("option",{value:"",children:"All Plans"}),e.jsx("option",{value:"trial",children:"Trial"}),e.jsx("option",{value:"free",children:"Free"}),e.jsx("option",{value:"starter",children:"Starter"}),e.jsx("option",{value:"growth",children:"Growth"}),e.jsx("option",{value:"pro",children:"Pro"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-slate-300 text-sm font-medium mb-2",children:"Sort By"}),e.jsxs("select",{value:a.sortBy,onChange:s=>d("sortBy",s.target.value),className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-blue-500",children:[e.jsx("option",{value:"name",children:"Name"}),e.jsx("option",{value:"createdAt",children:"Created Date"}),e.jsx("option",{value:"lastActivity",children:"Last Activity"}),e.jsx("option",{value:"carsCount",children:"Cars Count"}),e.jsx("option",{value:"leadsCount",children:"Leads Count"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-slate-300 text-sm font-medium mb-2",children:"Sort Order"}),e.jsxs("select",{value:a.sortOrder,onChange:s=>d("sortOrder",s.target.value),className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-blue-500",children:[e.jsx("option",{value:"asc",children:"Ascending"}),e.jsx("option",{value:"desc",children:"Descending"})]})]})]})]}),j&&e.jsx("div",{className:"bg-red-900/20 border border-red-800/50 rounded-xl p-6",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(w,{className:"w-5 h-5 text-red-400"}),e.jsx("p",{className:"text-red-400",children:j})]})}),g&&o.length===0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[1,2,3,4,5,6].map(s=>e.jsx("div",{className:"animate-pulse",children:e.jsxs("div",{className:"bg-slate-800 border border-slate-700 rounded-xl p-6",children:[e.jsx("div",{className:"w-12 h-12 bg-slate-700 rounded-lg mb-4"}),e.jsx("div",{className:"w-24 h-4 bg-slate-700 rounded mb-2"}),e.jsx("div",{className:"w-16 h-4 bg-slate-700 rounded mb-4"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx("div",{className:"w-12 h-8 bg-slate-700 rounded"}),e.jsx("div",{className:"w-12 h-8 bg-slate-700 rounded"})]})]})},s))}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("label",{className:"flex items-center space-x-2 text-slate-300",children:[e.jsx("input",{type:"checkbox",checked:i.length===o.length&&o.length>0,onChange:U,className:"rounded border-slate-600 bg-slate-700 text-blue-600 focus:ring-blue-500"}),e.jsx("span",{className:"text-sm",children:"Select All"})]}),e.jsxs("span",{className:"text-slate-400 text-sm",children:["Showing ",o.length," of ",c.total," tenants"]})]})}),o.length>0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:o.map(s=>e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"checkbox",checked:i.includes(s.id),onChange:()=>L(s.id),className:"absolute top-4 left-4 z-10 rounded border-slate-600 bg-slate-700 text-blue-600 focus:ring-blue-500"}),e.jsx(xe,{tenant:s,onEdit:x,onSuspend:E,onActivate:B,onViewAnalytics:O})]},s.id))}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx(Building2,{className:"w-16 h-16 text-slate-600 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-white mb-2",children:"No tenants found"}),e.jsx("p",{className:"text-slate-400 mb-6",children:a.search||a.status||a.plan?"Try adjusting your search or filters":"Get started by creating your first tenant"}),e.jsxs("button",{onClick:()=>t("/super-admin/tenants/create"),className:"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors flex items-center space-x-2 mx-auto",children:[e.jsx(P,{className:"w-5 h-5"}),e.jsx("span",{children:"Create First Tenant"})]})]}),c.totalPages>1&&e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-slate-400",children:["Page ",a.page," of ",c.totalPages]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>d("page",a.page-1),disabled:!c.hasPrev,className:"px-3 py-2 text-slate-300 hover:text-white hover:bg-slate-700 rounded-lg disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:"Previous"}),[...Array(c.totalPages)].map((s,l)=>{const r=l+1,H=r===a.page;return!(Math.abs(r-a.page)<=2||r===1||r===c.totalPages)&&r!==1&&r!==c.totalPages?r===a.page-3||r===a.page+3?e.jsx("span",{className:"text-slate-500",children:"..."},r):null:e.jsx("button",{onClick:()=>d("page",r),className:`px-3 py-2 rounded-lg transition-colors ${H?"bg-blue-600 text-white":"text-slate-300 hover:text-white hover:bg-slate-700"}`,children:r},r)}),e.jsx("button",{onClick:()=>d("page",a.page+1),disabled:!c.hasNext,className:"px-3 py-2 text-slate-300 hover:text-white hover:bg-slate-700 rounded-lg disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:"Next"})]})]})]})]})}export{Ne as TenantsPage};
